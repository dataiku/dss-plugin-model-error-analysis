<div class="selected-node-info">
    <div class="statistics-section">
        <div class="placeholder-node">
            <svg height="100%" width="100%"></svg>
        </div>
        <div>
            <p>
                <strong>{{ selectedNode.samples[0] }}</strong> samples (<strong>{{ toFixedIfNeeded(selectedNode.samples[1], 2, true) }}%</strong> of the whole dataset).
            </p>
            <p>
                Global error (% wrong predictions over total) is <strong>{{ toFixedIfNeeded(selectedNode.global_error*100, 2, true) }}%</strong>.
            </p>
            <p>
                Local error (% wrong predictions over node samples) is <strong>{{ toFixedIfNeeded(selectedNode.localError*100, 2, true) }}%</strong>.
            </p>
        </div>
    </div>
    <div class="decision-rule-section" ng-if="decisionRule.length > 0">
        <div class="header">
            <div class="header-decision-rule header-div">
                Decision rule
            </div>
        </div>
        <div class="info-section" ng-class="{'info-section--expanded': displayRule}">
            <div class="info" ng-repeat="rule in decisionRule" title="{{ rule.left + ' ' + rule.middle + ' ' + rule.right }}">
                <span ng-if="$index">â†³&nbsp;</span>
                <div class="ellipsed-text" ng-class="{'no-shrink-no-grow': rule.numerical, 'no-grow': !rule.numerical}" ng-if="rule.left">{{ rule.left }}&nbsp;</div>
                <div class="ellipsed-text" ng-class="{'no-shrink-no-grow': !rule.numerical, 'no-grow': rule.numerical}">{{ rule.middle }}&nbsp;</div>
                <div class="ellipsed-text" ng-class="{'no-shrink-no-grow': rule.numerical, 'no-grow': !rule.numerical}" ng-if="rule.right">{{ rule.right }}</div>
            </div>
        </div>
        <div ng-show="decisionRule.length > 3">
            <span class="link" ng-click="displayRule = !displayRule">
                Show {{ displayRule ? 'less' : 'more' }}<i class="chevron-no-decoration" ng-class="{'icon-chevron-down': !displayRule, 'icon-chevron-up': displayRule}"></i>
            </span>
        </div>
    </div>
</div>

<div class="histograms-container">
    <div class="legend-container">
        <div class="feature-selector">
            <span class="feature-selector__title" ng-click="openFeatureSelector()">Feature distribution <i class="icon-caret-down"></i></span>
            <div class="feature-selector__body" ng-if="featureSelectorShown">
                <div class="feature-selector-row" ng-click="feature.$selected = !feature.$selected" ng-repeat="feature in rankedFeatures">
                    <input type="checkbox" ng-model="feature.$selected" ng-click="$event.stopPropagation()">
                    &nbsp;
                    <i class="icon-font" ng-show="!feature.numerical"></i>
                    <div class="numerical" ng-show="feature.numerical">#</div>
                    <div class="ellipsed-text">&nbsp;{{ feature.name }}</div>
                </div>
            </div>
        </div>
        <div class="legend-details">
            <svg height="20px" width="50%">
                <g>
                    <rect height="20" width="8" x="4" fill="{{colors['Wrong prediction']}}"></rect>
                    <rect height="20" width="8" x="12" fill="{{colors['Correct prediction']}}"> </rect>
                    <text x="24" y="15">Local (this node)</text>
                </g>
            </svg>
            <svg height="20px" width="50%">
                <g>
                    <rect class="color-bar__global-legend" height="20" width="8" x="4" fill="{{colors['Wrong prediction']}}"></rect>
                    <rect class="color-bar__global-legend" height="20" width="8" x="12" fill="{{colors['Correct prediction']}}"> </rect>
                    <text x="24" y="15">Global (whole set)</text>
                </g>
            </svg>
        </div>
    </div>
    <div class="histograms">  
        <div ng-repeat="feature in rankedFeatures | orderBy: 'rank'" ng-if="feature.$selected">
            <div class="header header-feature">
                <div class="header-feature-desc  header-div header-div--uppercase">
                    <i class="icon-font header__icon" ng-show="!feature.numerical"></i>
                    <div class="numerical header__icon" ng-show="feature.numerical">#</div>
                    <div class="ellipsed-text" title="{{feature.name}}">&emsp;{{feature.name}}</div>
                </div>
            </div>
            <div class="histogram-placeholder histogram-placeholder-empty" ng-if="histData[feature.name] && histData[feature.name].count.length == 0">
                <em>No values</em>
            </div>
            <div class="histogram-placeholder" ng-if="!histData[feature.name]">
                <spinner></spinner>
            </div>
            <div histogram="{{feature.name}}" class="histogram-placeholder" ng-if="histData[feature.name] && histData[feature.name].count.length > 0">
                <div class="histogram-svg"></div>
            </div>
        </div>
    </div>
</div>
