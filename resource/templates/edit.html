<div class="template" ng-controller="EditController" ng-click="closeColorPicker($event)" ng-keydown="saveShortcut($event)" tabindex="0">
    <div ng-if="modal.type"
         class="modal-background"
         tabindex=0
         ng-keyup="$event.keyCode == 27 && removeModal()"
         ng-click="removeModal($event)">
    </div>
    <div class="tree-visualization" ng-class="{'full-screen': template === 'sun'}">
        <div class="toolbar-header">
            <div class="icons-div" ng-class="{'icons-div-tree': template === 'viz', 'icons-div-sun': template === 'sun'}">
                <i class="icon icon-tint icon-grey"
                    title="Change color scale"
                    ng-click="displayColorPicker = !displayColorPicker">
                </i>
                <div class="icons-toggle">
                    <i class="icon icon-eye-open"
                       ng-class="{'toolbar-selected': template === 'viz'}"
                       title="Tree visualization"
                       ng-click="setTemplate('viz')">
                    </i>
                    <img class="icon sunburst"
                         ng-class="{'toolbar-selected': template === 'sun'}"
                         src="/plugins/model-error-analysis/resource/img/sunburst.png"
                         title="Sunburst visualization"
                         ng-click="setTemplate('sun')"
                         height="20px">
                    </img>
                </div>
                <img class="icon"
                     ng-if="template === 'viz'"
                     src="/plugins/model-error-analysis/resource/img/fit.png"
                     title="Zoom fit" ng-click="zoomFit()"
                     height="20px">
                </img>
                <img class="icon"
                     ng-if="template === 'viz'"
                     src="/plugins/model-error-analysis/resource/img/100.png"
                     title="Zoom 100%"
                     ng-click="zoomBack()"
                     height="20px">
                </img>
            </div>
        </div>
        <div ng-class="template == 'sun' ? 'tree-sunburst' : 'tree'">
            <div class="color-picker" ng-show="displayColorPicker">
                <div class="row-color-picker row"
                     ng-repeat="(name, scale) in scales"
                     ng-class="{'border-selected': scale == selectedScale}"
                     ng-click="scale != selectedScale && setScale(name)">
                    <ul class="color-bars-small color-bars">
                        <li ng-repeat="(targetValue, color) in displayScale(scale)"
                            class="color-bar"
                            ng-style="{'background': color}"></li>
                    </ul>
                    <div>{{name}}</div>
                </div>
            </div>
            <div id="leftsidebar" ng-if="template == 'sun'"></div>
            <div id="chart" ng-if="template == 'sun'"></div>
            <spinner ng-if="loadingTree"></spinner>
        </div>
    </div>
    <div class="histogram-panel" ng-include="'/plugins/model-error-analysis/resource/templates/histograms.html'" ng-if="selectedNode.id && !loadingHistogram && template === 'viz'"></div>
    <div class="empty-panel" ng-if="selectedNode && !selectedNode.id && template === 'viz'">
        <div>
            Select a node
        </div>
    </div>
</div>
